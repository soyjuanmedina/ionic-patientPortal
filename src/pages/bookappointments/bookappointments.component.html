<ion-header>
  <ion-navbar>
    <ion-title>Book appointments</ion-title>
  </ion-navbar>
</ion-header>

<ion-content padding>
  
  <h1 *ngIf="hospitals?.length == 1">{{hospitals[0].name}}</h1>
  
  <ion-list *ngIf="hospitals?.length > 1">
    <ion-item>
      <ion-label>Hospital</ion-label>
      <ion-select [(ngModel)]=searchterms.hospitalId>
        <ion-option *ngFor="let hospital of hospitals" [value]="hospital.id">{{ hospital.name }}</ion-option>
      </ion-select>
    </ion-item>
  </ion-list>

  <ion-list>
    <ion-item>
      <ion-label>Source of funding</ion-label>
      <ion-select [(ngModel)]=searchterms.payorId>
        <ion-option *ngFor="let payor of payors" [value]="payor.id">{{ payor.name }}</ion-option>
      </ion-select>
    </ion-item>
  </ion-list>

  <ion-list>
    <ion-item>
      <ion-label>Department</ion-label>
      <ion-select [(ngModel)]=searchterms.orgId [disabled]="!searchterms.payorId" (ngModelChange)=checkDepartment()>
        <ion-option *ngFor="let department of departments" [value]="department.id">{{ department.name }}</ion-option>
      </ion-select>
    </ion-item>
  </ion-list>

  <ion-list>
    <ion-item>
      <ion-label>Consultant</ion-label>
      <ion-select [(ngModel)]=searchterms.doctorId [disabled]="!searchterms.payorId" (ngModelChange)="searchSpecialties()">
        <ion-option *ngFor="let doctor of doctors" [value]="doctor.id">{{ doctor.name }}</ion-option>
      </ion-select>
    </ion-item>
  </ion-list>

  <ion-list>
    <ion-item>
      <ion-label>Consultants' Specialty</ion-label>
      <ion-select [(ngModel)]=searchterms.specialtyId [disabled]="!searchterms.payorId" (ngModelChange)="searchDoctors()">
        <ion-option *ngFor="let specialty of specialties" [value]="specialty.id">{{ specialty.name }}</ion-option>
      </ion-select>
    </ion-item>
  </ion-list>
  
  <ion-list>
    <ion-item>
      <ion-label>Visit type</ion-label>
      <ion-select [(ngModel)]=searchterms.specialtyId [disabled]="!searchterms.payorId">
        <ion-option *ngFor="let visitType of visitTypes" [value]="visitType.id">{{ visitType.name }}</ion-option>
      </ion-select>
    </ion-item>
  </ion-list>

  <ion-item>
    <ion-label>Date</ion-label>
      <ion-datetime displayFormat="DD MMM YYYY" [(ngModel)]="searchterms.date"></ion-datetime>
  </ion-item>

  <button ion-button block [disabled]="!searchterms.payorId" (click)="searchFreeSlots()">Search</button>


  <ion-list>
    <button ion-item *ngFor="let freeslot of freeslots" (click)="itemSelected(freeslot)">
      {{ freeslot.date }} | {{ freeslot.hour }}
    </button>
  </ion-list>

  <pre>

     {{ freeslots }}
  
    {{ searchterms | json }}

    
  
  </pre>
  

</ion-content>